<!DOCTYPE html>
<html lang='ru'>
<head>
  <meta charset='UTF-8' />
  <title></title>
</head>
<body>
<!--    <template id="clock-template">
      <div>{{ time }}</div>
    </template>-->

<main id='app'></main>

<script type='module'>
  // import { createApp, defineComponent } from './vendor/vue.esm-browser.js';

  // асинхронная регистрация компонента с помощью defineAsyncComponent
  import { createApp, defineComponent, defineAsyncComponent } from './vendor/vue.esm-browser.js';
  import AppClock from './AppClock.js';

  /*const AppClock = defineComponent({
    name: 'AppClock', // почему name ВНЕ data() ?

    data() {
      return {
        time: '',
        intervalId: null,
      };
    },

    created() {
      this.updateTime();
      this.intervalId = setInterval(() => {
        this.updateTime();
      }, 1000);
    },

    beforeUnmount() {
      clearInterval(this.intervalId);
    },

    methods: {
      updateTime() {
        this.time = new Date().toLocaleTimeString();
      },
    },

    template: `
      <div>{{ time }}</div>`,
  });*/

  const App = defineComponent({
    name: 'App',


    // Локальная реристрация компонента; Регистрируем компонент там, где будем его использовать, например, Часы будем использовать в App, значит в нем локально и регистрируем:
    components: {
      // регистрация компонента:
      // AppClock: AppClock,

      // асинхронная регистрация компонента с помощью defineAsyncComponent, т.е. при рендеринге App, Vue еще не получил AppClock
      AppClock: defineAsyncComponent(() => Promise.resolve(AppClock)),

      // динамический импорт
      // AppClock: defineAsyncComponent(() => import(./AppClock.js)),
    },

    template: `
      <div class='App'>
      <span>Clock:</span>

      <!-- camelCase -->
      <AppClock />

      <!-- kebab-case (лучше этот использовать) -->
      <app-clock />
      </div>
    `,
  });

  const app = createApp(App);

  // глобальная регистрация компонента, т.е. он может использоваться везде
  // app.component('app-clock', AppClock);

  const vm = app.mount('#app');
</script>
</body>
</html>
